<section class="admin-card">
  <header>
    <h1>Opening Hours Admin</h1>
    <p>Configure the business opening schedule and publish once complete.</p>
  </header>

  <form [formGroup]="form" (ngSubmit)="save()">
    <div class="meta-grid">
      <label>
        Timezone
        <input type="text" formControlName="timezone" placeholder="Europe/London" />
      </label>

      <label>
        Effective from
        <input type="date" formControlName="effectiveFrom" />
      </label>
    </div>

    <div formArrayName="days" class="day-list">
      <article
        class="day-card"
        *ngFor="let dayForm of dayForms.controls; let dayIndex = index; trackBy: trackByDay"
        [formGroupName]="dayIndex"
      >
        <div class="day-header">
          <h2>{{ weekdays[dayIndex].label }}</h2>
          <label class="toggle">
            <input type="checkbox" formControlName="enabled" />
            Open this day
          </label>
        </div>

        <div formArrayName="slots" class="slots" *ngIf="dayForm.controls.enabled.value; else closedTemplate">
          <div class="slot-row" *ngFor="let slot of slotForms(dayIndex).controls; let slotIndex = index" [formGroupName]="slotIndex">
            <label>
              Opens
              <input type="time" formControlName="opensAt" />
            </label>

            <label>
              Closes
              <input type="time" formControlName="closesAt" />
            </label>

            <button type="button" class="danger" (click)="removeSlot(dayIndex, slotIndex)">Remove</button>
          </div>

          <button type="button" class="secondary" (click)="addSlot(dayIndex)">Add time slot</button>
        </div>

        <ng-template #closedTemplate>
          <p class="closed-pill">Closed</p>
        </ng-template>
      </article>
    </div>

    <div class="actions">
      <button type="submit">Save opening hours</button>
    </div>
  </form>

  <section class="preview">
    <h3>Payload preview</h3>
    <pre>{{ serializedSchedule() }}</pre>
  </section>
</section>
